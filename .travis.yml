dist: trusty
sudo: required
addons:
  chrome: stable
  postgresql: 9.6
services:
  - postgresql
language: ruby
cache: bundler
rvm:
  - 2.4.2
before_script:
  - psql -c 'create database move_mil_test;' -U postgres
script:
  - bundle exec rake
  - bundle exec rubocop
  - bundle exec brakeman
deploy:
  - provider: elasticbeanstalk
    access_key_id: $AWS_ACCESS_KEY_ID
    secret_access_key: $AWS_SECRET_ACCESS_KEY
    region: us-east-1
    app: move.mil
    env: move-mil-staging
    bucket_name: elasticbeanstalk-us-east-1-321940898149
    bucket_path: move-mil-staging
    on:
      branch: master
  - provider: elasticbeanstalk
    access_key_id: $AWS_ACCESS_KEY_ID
    secret_access_key: $AWS_SECRET_ACCESS_KEY
    region: us-east-1
    app: move.mil
    env: move-mil-prod
    bucket_name: elasticbeanstalk-us-east-1-321940898149
    bucket_path: move-mil-prod
    on:
      branch: production
notifications:
  email: false
  slack:
    rooms:
      - secure: WjMfd2c5YoG195JkcZOw3dpmW6Ib3A6ejTsgutoD3W+yU/50wBAVwWZP2idpkCK496Ps2YCjVgcxTxy/R2Dz6cHSmX2NJQK2plGR/BU7RBsVVXSnOFDBcWCVDzyfjmjcXWarl0DTUB41ljp7gT9zIWJ8JOZO02IOYRyxxS3yxZdKtSp6VpJCLh2AOx7S8zq6Juwt75X8tvPu+n3rPz3dLT861k8+vkowv5FNC98E4tStorma+x6Di43InFLdw1XsAqY0rdhe9WBeNTXbKuGklQ718iSH23uwYOkzn2QMNGHbOx9s/zjXhhbsAZwTsLETbhqqqaNOfzh+WHk3OmmWaXTNVH5kACt8a6HRieiOF+wKqchuK5Z0sGAWyqN/tGulIntf0m18dPa+ViucHqfMhNkx4ND8Qja9XMt8gqN5nkwptmPvATDNysdRoaUAKGP8/RDpJwokiozMlepvgBbMaxLyKYGIdoO/+8L16GITVNxJg7IGpOg1e7kz/BpBkjye9dr2/+FGQlXT5krU0cVcsZU9rjDIbXriAfZFSttvKLpzvcahv1gxA/KITudkdYO+buQO1lvkLV48RxOTKSn21yEGW80QV/Lr3+subyFZG+TL8g/UiTSp3jNLIajwigi/cPT0pEFnmuwFQCN4qC0gu4mYvypfJQhdeN9lF6Ga4L4=

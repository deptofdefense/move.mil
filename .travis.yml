dist: trusty
sudo: required
addons:
  chrome: stable
  postgresql: 9.6
services:
  - postgresql
language: ruby
cache: bundler
rvm:
  - 2.4.2
before_script:
  - psql -c 'create database move_mil_test;' -U postgres
script:
  - bundle exec rake
  - bundle exec rubocop
  - bundle exec brakeman
deploy:
  - provider: elasticbeanstalk
    access_key_id: $AWS_ACCESS_KEY_ID
    secret_access_key: $AWS_SECRET_ACCESS_KEY
    region: us-east-1
    app: move.mil
    env: move-mil-staging
    bucket_name: elasticbeanstalk-us-east-1-321940898149
    bucket_path: move-mil-staging
    on:
      branch: master
  - provider: elasticbeanstalk
    access_key_id: $AWS_ACCESS_KEY_ID
    secret_access_key: $AWS_SECRET_ACCESS_KEY
    region: us-east-1
    app: move.mil
    env: move-mil-prod
    bucket_name: elasticbeanstalk-us-east-1-321940898149
    bucket_path: move-mil-prod
    on:
      branch: production
notifications:
  email: false
  slack:
    secure: uC5YASgSaOie5IfxvGL23rAXgSTmCONdWqKftE6DIcKuM/m5wdd7I8Re1I3WBrIRurCfGEmTzHaM8Jycx2Qt3Rd9b7/n8VE3/Un+Zj9DIsWShekXGxSh2w291d4RI4Kt+IadABYCUwQnbyQW1UsZOdaECSkvCFYv4I0ni3gE2jPWTm3yyxIYV8ncUTIv3k6x14GNAg147mG53Uov9LwDxqrtbDEPNmclPk2P+bAk5UrERq8EyQEWldxQOalwJjyQ6iPLinbrSHYOgQie9Bq5YMTiWEzoZl1GLQvRoa2KhfdWycOvc7yvx313XAl0uWZ6igSWc2dxM1m4a3dP1X07mHwSseINK3thPsSpvv7mzF2EGsGi65Fm2jjJhH+fVJK7mkIsGX4bvCYFcWWQP0LE5hb0A8R9tg2/l6vHuTKXntzeTRz0U3n7crbah/ZO4rCoPcO8ffht9ZH7K0kwWNOjng5j+r5EFSkgkqCJpDdrMDlLL4zQxOzE1sE/mbIQMKGdnNCKfVCFiz+ZqMhwcesgIefr7wRb/E7lltbVYH8PVCz5yg6JPb2Aa5NBnXwCw+s21ex5gD4XwY1WDoNXjp+yPFsUJwQmvYjx6Mq6aZrC3oDUn4TquG0pxXPWUbKZEsGS009BLVDHJBKsk5euXApx8sfLy4rGA75sxS7jg25Lf2g=
